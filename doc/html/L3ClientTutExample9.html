<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.8"/>
<title>.NET Based OPC UA Client/Server/PubSub SDK: Read – Read With Data Encoding</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="customdoxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="header_inner_inner_bg2.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">.NET Based OPC UA Client/Server/PubSub SDK
   &#160;<span id="projectnumber">4.1.0.556</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.8 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Packages</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('L3ClientTutExample9.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Properties</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Events</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Modules</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Read – Read With Data Encoding </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#L4ClientTutExample9Pre">Prerequisites</a></li>
<li class="level1"><a href="#L4ClientTutExample9Desc">Description</a></li>
<li class="level1"><a href="#L4ClientTutExample9Code">Sample Code</a></li>
</ul>
</div>
<div class="textblock"><h1><a class="anchor" id="L4ClientTutExample9Pre"></a>
Prerequisites</h1>
<p>A session with the server must be established.</p>
<h1><a class="anchor" id="L4ClientTutExample9Desc"></a>
Description</h1>
<p>The following dialog shows an example implementation of the Read service. Press the button “Show Code” to display the corresponding code, and the button “Help” to show this documentation page.</p>
<div class="image">
<img src="clienttutorials_read_with_data_encoding.png" alt="clienttutorials_read_with_data_encoding.png"/>
</div>
<p>Press the button “...” to open a Browse window and select a NodeId of a variable with a structured DataType, e.g. <em>ServerStatus</em>. Confirm your choice by pressing “OK”.</p>
<div class="image">
<img src="clienttutorials_read_attribute2.png" alt="clienttutorials_read_attribute2.png"/>
</div>
<p>The NodeId is now displayed in the field “Node Id” and the drop-down shows all available Data Encodings for the DataType of the selected Variable node. Standard values are “Default Binary” and “Default XML”.</p>
<div class="image">
<img src="clienttutorials_read_with_data_encoding2.png" alt="clienttutorials_read_with_data_encoding2.png"/>
</div>
<p>On pressing the button “Read”, the variable is read using the specified data encoding and the response is displayed at “Read Response”. Check the box in front of “Use Asynchronous Pattern” to call “BeginRead” instead of “Read”.</p>
<div class="image">
<img src="clienttutorials_read_with_data_encoding3.png" alt="clienttutorials_read_with_data_encoding3.png"/>
</div>
 <div class="image">
<img src="clienttutorials_read_with_data_encoding4.png" alt="clienttutorials_read_with_data_encoding4.png"/>
</div>
<h1><a class="anchor" id="L4ClientTutExample9Code"></a>
Sample Code</h1>
<p>Calling the <a class="el" href="classUnifiedAutomation_1_1UaClient_1_1Session.html#a0e9e131bd5ac7158dc6d343e083b8ee0">Read</a> service itself works in the same way as shown in the other Read examples. The difference is that the <a class="el" href="classUnifiedAutomation_1_1UaBase_1_1ReadValueId.html#a8571a661a459b1cb5d04e9b646056a16">DataEncoding</a> is set in the <a class="el" href="classUnifiedAutomation_1_1UaBase_1_1ReadValueId.html">ReadValueId</a>. In this example, the <a class="el" href="classUnifiedAutomation_1_1UaBase_1_1ReadValueId.html#a8571a661a459b1cb5d04e9b646056a16">DataEncoding</a> can be set in the GUI. The <a class="el" href="classUnifiedAutomation_1_1UaClient_1_1Session.html#a7f59f07befcd293c3595db515218820a">CacheManager</a> of the session is used to get the BrowseName of the encoding node.</p>
<ul>
<li><a class="el" href="classUnifiedAutomation_1_1UaBase_1_1ReadValueId.html#a8571a661a459b1cb5d04e9b646056a16">DataEncoding</a></li>
<li><a class="el" href="classUnifiedAutomation_1_1UaBase_1_1ReadValueId.html">ReadValueId</a></li>
</ul>
<div class="fragment"><div class="line">        <span class="keyword">private</span> List&lt;ReadValueId&gt; PrepareRequest(Session session)</div>
<div class="line">        {</div>
<div class="line">            <span class="comment">// nothing to do if no session.</span></div>
<div class="line">            <span class="keywordflow">if</span> (session == null)</div>
<div class="line">            {</div>
<div class="line">                <span class="keywordflow">return</span> null;</div>
<div class="line">            }</div>
<div class="line"></div>
<div class="line">            <span class="comment">// need the browse name of the encoding to pass with the request.</span></div>
<div class="line">            <a class="code" href="namespaceUnifiedAutomation_1_1UaBase.html#a5c65b5d5d05c3f82bdeef88928d74328ab4a75c1b2cfd3cb752898835cad346b0">QualifiedName</a> dataEncoding = null;</div>
<div class="line"></div>
<div class="line">            <span class="keywordflow">if</span> (DataEncodingCB.SelectedIndex &gt;= 0)</div>
<div class="line">            {</div>
<div class="line">                <span class="comment">// Get the BrowseName of the selected encoding node.</span></div>
<div class="line">                <span class="comment">// Standard values are QualifiedName(&quot;Default Binary&quot;) and QualifiedName(&quot;Default XML&quot;).</span></div>
<div class="line">                dataEncoding = session.Cache.GetAttribute&lt;<a class="code" href="namespaceUnifiedAutomation_1_1UaBase.html#a5c65b5d5d05c3f82bdeef88928d74328ab4a75c1b2cfd3cb752898835cad346b0">QualifiedName</a>&gt;(</div>
<div class="line">                        ((DropDownItem)DataEncodingCB.SelectedItem).DataEncoding,</div>
<div class="line">                        Attributes.BrowseName,</div>
<div class="line">                        null);</div>
<div class="line">            }</div>
<div class="line"></div>
<div class="line">            <span class="comment">// build a list of values to read.</span></div>
<div class="line">            List&lt;ReadValueId&gt; nodesToRead = <span class="keyword">new</span> List&lt;ReadValueId&gt;();</div>
<div class="line"></div>
<div class="line">            <span class="comment">// assume we are reading a variable so the default attribute is the Value attribute.</span></div>
<div class="line">            nodesToRead.Add(<span class="keyword">new</span> ReadValueId()</div>
<div class="line">            {</div>
<div class="line">                <a class="code" href="namespaceUnifiedAutomation_1_1UaBase.html#a5c65b5d5d05c3f82bdeef88928d74328a4b5bd8a54893c87287a22228b5ef2bc8">NodeId</a> = <a class="code" href="namespaceUnifiedAutomation_1_1UaBase.html#a5c65b5d5d05c3f82bdeef88928d74328a4b5bd8a54893c87287a22228b5ef2bc8">NodeId</a>.Parse(NodeIdTB.Text),</div>
<div class="line">                AttributeId = Attributes.Value,</div>
<div class="line">                DataEncoding = dataEncoding</div>
<div class="line">            });</div>
<div class="line"></div>
<div class="line">            <span class="keywordflow">return</span> nodesToRead;</div>
<div class="line">        }</div>
</div><!-- fragment --><p> In most use cases, one of the standard encodings “Default Binary” or “Default XML” is used. Then you can hard code the DataEncodings with</p>
<div class="fragment"><div class="line"><span class="keyword">new</span> <a class="code" href="namespaceUnifiedAutomation_1_1UaBase.html#a5c65b5d5d05c3f82bdeef88928d74328ab4a75c1b2cfd3cb752898835cad346b0">QualifiedName</a>(UaBase.BrowseNames.DefaultBinary)</div>
</div><!-- fragment --><p>or</p>
<div class="fragment"><div class="line"><span class="keyword">new</span> <a class="code" href="namespaceUnifiedAutomation_1_1UaBase.html#a5c65b5d5d05c3f82bdeef88928d74328ab4a75c1b2cfd3cb752898835cad346b0">QualifiedName</a>(UaBase.BrowseNames.DefaultXml)</div>
</div><!-- fragment --> </div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="L1ClientTutorials.html">Tutorials for Client development</a></li><li class="navelem"><a class="el" href="L2ClientTutExamples.html">Getting Started</a></li>
    <li class="footer">&copy; Unified Automation GmbH - All rights reserved.</li>
  </ul>
</div>
</body>
</html>
