<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.8"/>
<title>.NET Based OPC UA Client/Server/PubSub SDK: User Management</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="customdoxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="header_inner_inner_bg2.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">.NET Based OPC UA Client/Server/PubSub SDK
   &#160;<span id="projectnumber">4.1.0.556</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.8 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Packages</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('L2ServerSdkServerUserManagement.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Properties</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Events</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Modules</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">User Management </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#L3ServerSdkIUserManager">IUserManager Interface</a></li>
<li class="level1"><a href="#L3FileBasedUserManagement">FileBasedUserManager</a><ul><li class="level2"><a href="#L4FileBasedUserManagementOverview">Overview</a></li>
<li class="level2"><a href="#L4FileBasedUserManagementServerConfiguration">Server Configuration</a></li>
<li class="level2"><a href="#L4FileBasedUserManagementUserManaging">Manage Users</a></li>
</ul>
</li>
</ul>
</div>
<div class="textblock"><h1><a class="anchor" id="L3ServerSdkIUserManager"></a>
IUserManager Interface</h1>
<p>Use the <a class="el" href="interfaceUnifiedAutomation_1_1UaServer_1_1IUserManager.html">IUserManager</a> interface to implement your own User Management. It provides basic methods for user handling which will be called through UA Methods by the <a class="el" href="classUnifiedAutomation_1_1UaServer_1_1UserManagementModel.html">UserManagementModel</a>. The <a class="el" href="classUnifiedAutomation_1_1UaServer_1_1UserManagementModel.html">UserManagementModel</a> provides all user information and methods in the servers address space.</p>
<h1><a class="anchor" id="L3FileBasedUserManagement"></a>
FileBasedUserManager</h1>
<h2><a class="anchor" id="L4FileBasedUserManagementOverview"></a>
Overview</h2>
<p>The Server SDK has its own implementation of the <a class="el" href="interfaceUnifiedAutomation_1_1UaServer_1_1IUserManager.html">IUserManager Interface</a> in the <a class="el" href="classUnifiedAutomation_1_1UaServer_1_1FileBasedUserManager.html">FileBasedUserManager</a>.</p>
<p>The <a class="el" href="classUnifiedAutomation_1_1UaServer_1_1FileBasedUserManager.html">FileBasedUserManager</a> stores all user information in memory as well as XML file on your hard disk. All password information will be encrypted as salted hashes.</p>
<h2><a class="anchor" id="L4FileBasedUserManagementServerConfiguration"></a>
Server Configuration</h2>
<p>To enable the File Based User Management add the following lines to the ServerSettings section in your server configuration:</p>
<p><b>XML configuration</b> </p><div class="fragment"><div class="line">&lt;UserIdentity&gt;</div>
<div class="line">  &lt;EnableUserName&gt;<span class="keyword">true</span>&lt;/EnableUserName&gt;</div>
<div class="line">  &lt;UserManagement FilePath=<span class="stringliteral">&quot;%CommonApplicationData%\unifiedautomation\UaSdkNet\Configuration\DemoServerUserConfiguration.xml&quot;</span> /&gt;</div>
<div class="line">&lt;/UserIdentity&gt;</div>
</div><!-- fragment --><p><b>In Memory Configuration</b> </p><div class="fragment"><div class="line">UserIdentity = <span class="keyword">new</span> UserIdentitySettings()</div>
<div class="line">{</div>
<div class="line">    EnableUserName = <span class="keyword">true</span>,</div>
<div class="line">    UserManagement = <span class="keyword">new</span> UserManagementSettings()</div>
<div class="line">    {</div>
<div class="line">        FilePath = <span class="stringliteral">&quot;%CommonApplicationData%\unifiedautomation\UaSdkNet\Configuration\DemoServerUserConfiguration.xml&quot;</span></div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment --><p>If the file does not exits at the configured file path, the SDK will create a new, empty one.</p>
<p>More configuration options can be found in the <a class="el" href="L2BaseLibConfigSchema.html#L3BaseLibConfigSchemaUserManagementSettings">UserManagementSettings</a>.</p>
<h2><a class="anchor" id="L4FileBasedUserManagementUserManaging"></a>
Manage Users</h2>
<p>The FileBasedUserManagement allows to manage users online or at server startup via a prepared user configuration file.</p>
<p><b>Manage Users Before Startup</b> <br />
For adding the users at startup, write a user configuration XML file with the following syntax: </p><div class="fragment"><div class="line">&lt;?xml version=<span class="stringliteral">&quot;1.0&quot;</span> encoding=<span class="stringliteral">&quot;utf-8&quot;</span>?&gt;</div>
<div class="line">&lt;UserConfiguration xmlns:xsi=<span class="stringliteral">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span> xmlns:xsd=<span class="stringliteral">&quot;http://www.w3.org/2001/XMLSchema&quot;</span> xmlns=<span class="stringliteral">&quot;http://unifiedautomation.com/schemas/UserConfiguration.xsd&quot;</span>&gt;</div>
<div class="line">  &lt;UserProfiles&gt;</div>
<div class="line">    &lt;<a class="code" href="namespaceUnifiedAutomation_1_1UaBase.html#a5d424275bc4d7da56358b5f10387776ea8f9bfe9d1345237cb3b2b205864da075">User</a>&gt;</div>
<div class="line">      &lt;Username&gt;john&lt;/Username&gt;</div>
<div class="line">      &lt;Password&gt;</div>
<div class="line">        &lt;PasswordClearText&gt;master&lt;/PasswordClearText&gt;</div>
<div class="line">      &lt;/Password&gt;</div>
<div class="line">    &lt;/<a class="code" href="namespaceUnifiedAutomation_1_1UaBase.html#a5d424275bc4d7da56358b5f10387776ea8f9bfe9d1345237cb3b2b205864da075">User</a>&gt;</div>
<div class="line">  &lt;/UserProfiles&gt;</div>
<div class="line">&lt;/UserConfiguration&gt;</div>
</div><!-- fragment --><p>For more configuration options look at the UserConfiguration XML schema provided with the SDK installer. Some of these options need to be explicitly supported by the Server. At server startup the SDK will decrypt all user passwords as salted hashes. </p><dl class="section note"><dt>Note</dt><dd>The XML file will be rewritten, please check if the server has write permissions for the file.</dd></dl>
<p>After startup the file will look like this(Hash and salt vary due to random salt generation): </p><div class="fragment"><div class="line">&lt;?xml version=<span class="stringliteral">&quot;1.0&quot;</span> encoding=<span class="stringliteral">&quot;utf-8&quot;</span>?&gt;</div>
<div class="line">&lt;UserConfiguration xmlns:xsi=<span class="stringliteral">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span> xmlns:xsd=<span class="stringliteral">&quot;http://www.w3.org/2001/XMLSchema&quot;</span> xmlns=<span class="stringliteral">&quot;http://unifiedautomation.com/schemas/UserConfiguration.xsd&quot;</span>&gt;</div>
<div class="line">  &lt;UserProfiles&gt;</div>
<div class="line">    &lt;<a class="code" href="namespaceUnifiedAutomation_1_1UaBase.html#a5d424275bc4d7da56358b5f10387776ea8f9bfe9d1345237cb3b2b205864da075">User</a>&gt;</div>
<div class="line">      &lt;Username&gt;john&lt;/Username&gt;</div>
<div class="line">      &lt;Password&gt;</div>
<div class="line">        &lt;HashContainer&gt;</div>
<div class="line">          &lt;Hash&gt;muIx+J15L+E878vdcrqI+baV85HwAFnAHDTH+7ZLiKWLi/bq7Y1iwiQZr5TULleRjg5jrFWVvdmbBixPJ/PR7w==&lt;/Hash&gt;</div>
<div class="line">          &lt;Salt&gt;MIeaO1rPkf3/hq11uiiWQQ==&lt;/Salt&gt;</div>
<div class="line">        &lt;/HashContainer&gt;</div>
<div class="line">      &lt;/Password&gt;</div>
<div class="line">    &lt;/<a class="code" href="namespaceUnifiedAutomation_1_1UaBase.html#a5d424275bc4d7da56358b5f10387776ea8f9bfe9d1345237cb3b2b205864da075">User</a>&gt;</div>
<div class="line">  &lt;/UserProfiles&gt;</div>
<div class="line">&lt;/UserConfiguration&gt;</div>
</div><!-- fragment --><p>Once written, the Server can also read the decrypted file at startup. If necessary, new users with clear text password can be added to the decrypted file as well. The SDK will decrypt them at next server startup.</p>
<dl class="section note"><dt>Note</dt><dd>The SDK's hash algorithm may not be compatible with other similar algorithms. Do not write your own hashes to avoid issues.</dd></dl>
<p><b>Manage Users Online</b> <br />
For the online configuration of the users, the server node will provide methods to manage the users. Look at the <em>ServerConfiguration &gt; UserManagement</em> node.</p>
<dl class="section note"><dt>Note</dt><dd>The ServerConfiguration node is only available for users with the <em>SecurityAdmin</em> role.</dd></dl>
<p>The UA UserManagement provides the following methods:</p><ul>
<li>AddUser</li>
<li>ModifyUser</li>
<li>RemoveUser</li>
<li>ChangePassword</li>
</ul>
<p>For more information about the UA Methods look at the <a href="https://reference.opcfoundation.org/Core/Part18/v105/docs/5.2" target="_blank">OPC Foundation Specification Part 18</a>.</p>
<dl class="section note"><dt>Note</dt><dd>The Server rewrites the user configuration file every successful UserManagement method call. For using the online configuration, the server needs write permissions for the user configuration file. </dd></dl>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="L1ServerSdkOverview.html">Server SDK Overview</a></li>
    <li class="footer">&copy; Unified Automation GmbH - All rights reserved.</li>
  </ul>
</div>
</body>
</html>
