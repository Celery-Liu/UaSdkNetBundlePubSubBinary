<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.8"/>
<title>.NET Based OPC UA Client/Server/PubSub SDK: Connect – Simple Connect</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="customdoxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="header_inner_inner_bg2.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">.NET Based OPC UA Client/Server/PubSub SDK
   &#160;<span id="projectnumber">4.1.0.556</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.8 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Packages</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('L3ClientTutExample5.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Properties</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Events</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Modules</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Connect – Simple Connect </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#L4ClientTutExample5Desc">Description</a></li>
<li class="level1"><a href="#L4ClientTutExample5Code">Sample Code</a></li>
</ul>
</div>
<div class="textblock"><h1><a class="anchor" id="L4ClientTutExample5Desc"></a>
Description</h1>
<p>The following dialog shows a simple example implementation of the Connect service. Press the button “Show Code” to display the corresponding code, and the button “Help” to show this documentation page.</p>
<dl class="section note"><dt>Note</dt><dd>This example demonstrates how to implement the Connect service. For this purpose, a new session with the server is opened. The settings performed using this dialog window do not affect the other Getting Started Examples.</dd></dl>
<div class="image">
<img src="clienttutorials_simple_connect.png" alt="clienttutorials_simple_connect.png"/>
</div>
<p>When pressing the button “Simple Connect”, a connection with the server specified at “Endpoint URL” is established, by default to the Unified Automation .NET Demo Server running on localhost.</p>
<p>At first, the client looks for available Endpoints. When a secure connection is chosen, the client connects to the Endpoint with the highest available security, otherwise an insecure connection is established, i.e. the Endpoint with Security Policy “None” is chosen.</p>
<p>Check the box at “Use Asynchronous Pattern” to call BeginConnect instead of Connect.</p>
<p><a class="anchor" id="simple_connect_certificates"></a> When choosing security, client and server have to trust each other’s certificate to enable a connection. In this example, a dialog window for trusting the server’s certificate is used. Press the button “Trust” to trust the certificate for this session and check “Save Certificate in TrustList” to accept the certificate permanently.</p>
<div class="image">
<img src="clienttutorials_simple_connect2.png" alt="clienttutorials_simple_connect2.png"/>
</div>
<p>To move the client’s certificate to the trust list of the Unified Automation .NET Demo Server, choose the tab “Rejected Certificates”, double-click on the client’s certificate in the list and choose “Trust” in the newly opened dialog window.</p>
<p>When the connection to the server is established this is indicated at connection state:</p>
<div class="image">
<img src="clienttutorials_simple_connect4.png" alt="clienttutorials_simple_connect4.png"/>
</div>
<p>This example shows different solutions for avoiding problems with clients that are not able to resolve DNS names. To establish a connection, the client needs to know the available Endpoints of a server. For this purpose, GetEndpoints is called first. The server then returns a list of available Endpoints, which may contain host names which the client cannot resolve and thus is not able to connect to these Endpoints.</p>
<p>When “UseDnsNameAndPortFromDiscoveryUrl” is checked, this problem is avoided by replacing the Endpoint URL recieved from the server with the URL which was used for GetEndpoints (i.e. the URL specified at “Endpoint URL”).</p>
<p>Another solution is using the UpdateEndpoint EventHandler:</p>
<p>If the Endpoint URL recieved from the server differs from the Discovery URL, the following dialog window is shown.</p>
<div class="image">
<img src="clienttutorials_simple_connect3.png" alt="clienttutorials_simple_connect3.png"/>
</div>
<p>There are three options:</p><ul>
<li>manually changing the Endpoint URL and confirming with “Update”</li>
<li>checking the box at “UseDnsNameAndPortFromDiscoveryUrl” and confirming with “Update” to connect to the Discovery URL</li>
<li>pressing the button “No Update” for using the Endpoint URL returned from the server</li>
</ul>
<dl class="section note"><dt>Note</dt><dd>In this example the UpdateEndpoint EventHandler shows a dialog. For that reason the EventHandler must not be enabled if the Connect method is called synchronously.</dd></dl>
<h1><a class="anchor" id="L4ClientTutExample5Code"></a>
Sample Code</h1>
<p>There are two relevant EventHandlers for this example. The EventHandlers have to be synchronized with the GUI thread.</p>
<div class="fragment"><div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> OnServerConnectionStatusUpdate(Session sender, ServerConnectionStatusUpdateEventArgs e)</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordflow">if</span> (InvokeRequired)</div>
<div class="line">            {</div>
<div class="line">                BeginInvoke(<span class="keyword">new</span> <a class="code" href="namespaceUnifiedAutomation_1_1UaClient.html#ad7097b81e3bf3b21172423a616357963">ServerConnectionStatusUpdateEventHandler</a>(OnServerConnectionStatusUpdate), sender, e);</div>
<div class="line">                <span class="keywordflow">return</span>;</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">switch</span> (e.Status)</div>
<div class="line">            {</div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="group__GroupNet__UaClientLibraryHelper.html#ga89f67ff8532517ecb6ccded3ffbeb722">ServerConnectionStatus</a>.Connected:</div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="group__GroupNet__UaClientLibraryHelper.html#ga89f67ff8532517ecb6ccded3ffbeb722">ServerConnectionStatus</a>.Connecting:</div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="group__GroupNet__UaClientLibraryHelper.html#ga89f67ff8532517ecb6ccded3ffbeb722">ServerConnectionStatus</a>.SessionAutomaticallyRecreated:</div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="group__GroupNet__UaClientLibraryHelper.html#ga89f67ff8532517ecb6ccded3ffbeb722">ServerConnectionStatus</a>.ConnectionErrorClientReconnect:</div>
<div class="line">                    SimpleConnectBTN.Enabled = <span class="keyword">false</span>;</div>
<div class="line">                    DisconnectBTN.Enabled = <span class="keyword">true</span>;</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="group__GroupNet__UaClientLibraryHelper.html#ga89f67ff8532517ecb6ccded3ffbeb722">ServerConnectionStatus</a>.LicenseExpired:</div>
<div class="line">                    SimpleConnectBTN.Enabled = <span class="keyword">false</span>;</div>
<div class="line">                    DisconnectBTN.Enabled = <span class="keyword">false</span>;</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">                <span class="keywordflow">default</span>:</div>
<div class="line">                    SimpleConnectBTN.Enabled = <span class="keyword">true</span>;</div>
<div class="line">                    DisconnectBTN.Enabled = <span class="keyword">false</span>;</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">            }</div>
<div class="line"></div>
<div class="line">            LabelConnectionState.Text = e.Status.ToString();</div>
<div class="line">            SetEndpointUrl();</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> OnUpdateEndpoint(Session sender, UpdateEndpointEventArgs e)</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordflow">if</span> (InvokeRequired)</div>
<div class="line">            {</div>
<div class="line">                Invoke(<span class="keyword">new</span> <a class="code" href="namespaceUnifiedAutomation_1_1UaClient.html#a2700df4561d24c85aa11d635062a07cc">UpdateEndpointEventHandler</a>(OnUpdateEndpoint), sender, e);</div>
<div class="line">                <span class="keywordflow">return</span>;</div>
<div class="line">            }</div>
<div class="line"></div>
<div class="line">            <span class="keywordflow">if</span> (!e.DiscoveryUrl.Equals(e.SelectedEndpoint.EndpointUrl))</div>
<div class="line">            {</div>
<div class="line">                EndpointUpdateDialog dlg = <span class="keyword">new</span> EndpointUpdateDialog();</div>
<div class="line">                dlg.ShowDialog(sender, e);</div>
<div class="line">                <span class="keywordflow">if</span> (dlg.DialogResult == DialogResult.OK)</div>
<div class="line">                {</div>
<div class="line">                    e.SelectedEndpoint.EndpointUrl = dlg.EndpointUrl;</div>
<div class="line">                    e.UseDnsNameAndPortFromDiscoveryUrl = dlg.UseDnsNameAndPortFromDiscoveryUrl;</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line">        }</div>
</div><!-- fragment --><p> The EventHandler OnServerConnectionStatusUpdate is added to the Session.</p>
<div class="fragment"><div class="line">            m_session.ConnectionStatusUpdate += OnServerConnectionStatusUpdate;</div>
</div><!-- fragment --><p> The following code shows how to connect synchronously to a server. In this example, Session.Connect is called from an own thread. This is necessary if the method is called from a GUI thread and the UpdateEndpoint EventHandler or the UntrustedCertificate EventHandler of the ApplicationInstance open dialogs. Otherwise the method can be called in the same thread directly.</p>
<div class="fragment"><div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> Connect()</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordflow">try</span></div>
<div class="line">            {</div>
<div class="line">                <span class="comment">// need to watch out for deadlocks if the GUI thread blocks.</span></div>
<div class="line">                <span class="comment">// This check is necessary if m_session.Connect is called from the GUI thread (== called in this method)</span></div>
<div class="line">                <span class="comment">//if (EnableUpdateEndpointEventHandler.Checked)</span></div>
<div class="line">                <span class="comment">//{</span></div>
<div class="line">                <span class="comment">//    MessageDialog.Show(this, &quot;Cannot use synchronous calls when expecting the UpdateEndpoint callback because a deadlock occurs when the callback tries to display the dialog.&quot;, Text, MessageBoxButtons.OK, MessageBoxIcon.Exclamation);</span></div>
<div class="line">                <span class="comment">//    return;</span></div>
<div class="line">                <span class="comment">//}</span></div>
<div class="line"></div>
<div class="line">                <span class="comment">// disconnect any existing session.</span></div>
<div class="line">                <span class="keywordflow">if</span> (m_session.ConnectionStatus != <a class="code" href="group__GroupNet__UaClientLibraryHelper.html#ga89f67ff8532517ecb6ccded3ffbeb722">ServerConnectionStatus</a>.Disconnected)</div>
<div class="line">                {</div>
<div class="line">                    m_session.Disconnect();</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">                <span class="comment">// Call the connect method from another thread to avoid threading problems</span></div>
<div class="line">                <span class="comment">// Possible problems are</span></div>
<div class="line">                <span class="comment">// - The UpdateEndpoint EventHandler opens a dialog</span></div>
<div class="line">                <span class="comment">// - The UntrustedCertificate EventHandler of the ApplicationInstance opens a dialog</span></div>
<div class="line">                Thread t = <span class="keyword">new</span> Thread(<span class="keyword">new</span> ParameterizedThreadStart(OnConnect));</div>
<div class="line">                t.Start(<span class="keyword">new</span> ConnectData()</div>
<div class="line">                {</div>
<div class="line">                    Session = m_session,</div>
<div class="line">                    EndpointUrl = EndpointUrl,</div>
<div class="line">                    Security = <a class="code" href="group__GroupNet__UaClientLibraryHelper.html#ga98100b962ed7252c384b7759085977f6">SecuritySelection</a></div>
<div class="line">                });</div>
<div class="line"></div>
<div class="line">                <span class="comment">// Call Connect from the GUI thread</span></div>
<div class="line">                <span class="comment">//m_session.Connect(EndpointUrl, SecuritySelection);</span></div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">catch</span> (Exception e)</div>
<div class="line">            {</div>
<div class="line">                ExceptionDlg.ShowInnerException(this.Text, e);</div>
<div class="line">            }</div>
<div class="line">        }</div>
</div><!-- fragment --><div class="fragment"><div class="line">        <span class="keyword">internal</span> <span class="keyword">class </span>ConnectData</div>
<div class="line">        {</div>
<div class="line">            <span class="keyword">public</span> Session Session;</div>
<div class="line">            <span class="keyword">public</span> <span class="keywordtype">string</span> EndpointUrl;</div>
<div class="line">            <span class="keyword">public</span> <a class="code" href="group__GroupNet__UaClientLibraryHelper.html#ga98100b962ed7252c384b7759085977f6">SecuritySelection</a> Security;</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="keyword">public</span> delegate <span class="keywordtype">void</span> ShowExceptionDelegate(<span class="keywordtype">string</span> text, Exception e);</div>
<div class="line"></div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> ShowException(<span class="keywordtype">string</span> text, Exception e)</div>
<div class="line">        {</div>
<div class="line">            ExceptionDlg.ShowInnerException(text, e);</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> OnConnect(<span class="keywordtype">object</span> state)</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordflow">if</span> (state == null)</div>
<div class="line">            {</div>
<div class="line">                <span class="keywordflow">return</span>;</div>
<div class="line">            }</div>
<div class="line">            ConnectData data = state as ConnectData;</div>
<div class="line">            <span class="keywordflow">if</span> (data == null)</div>
<div class="line">            {</div>
<div class="line">                <span class="keywordflow">return</span>;</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">try</span></div>
<div class="line">            {</div>
<div class="line">                data.Session.Connect(data.EndpointUrl, data.Security);</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">catch</span> (Exception e)</div>
<div class="line">            {</div>
<div class="line">                <span class="keywordflow">if</span> (InvokeRequired)</div>
<div class="line">                {</div>
<div class="line">                    Invoke(<span class="keyword">new</span> ShowExceptionDelegate(ShowException), this.Text, e);</div>
<div class="line">                    <span class="keywordflow">return</span>;</div>
<div class="line">                }</div>
<div class="line">                ExceptionDlg.ShowInnerException(this.Text, e);</div>
<div class="line">            }</div>
<div class="line">        }</div>
</div><!-- fragment --> <div class="fragment"><div class="line"><span class="keyword">private</span> <span class="keywordtype">void</span> Connect()</div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">try</span></div>
<div class="line">    {</div>
<div class="line"></div>
<div class="line">        <span class="comment">// disconnect any existing session.</span></div>
<div class="line">        <span class="keywordflow">if</span> (m_session.ConnectionStatus != <a class="code" href="group__GroupNet__UaClientLibraryHelper.html#ga89f67ff8532517ecb6ccded3ffbeb722">ServerConnectionStatus</a>.Disconnected)</div>
<div class="line">        {</div>
<div class="line">            m_session.Disconnect();</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="comment">// Call the connect method from another thread to avoid threading problems</span></div>
<div class="line">        <span class="comment">// Possible problems are</span></div>
<div class="line">        <span class="comment">// - The UpdateEndpoint EventHandler opens a dialog</span></div>
<div class="line">        <span class="comment">// - The UntrustedCertificate EventHandler of the ApplicationInstance opens a dialog</span></div>
<div class="line">        Thread t = <span class="keyword">new</span> Thread(<span class="keyword">new</span> ParameterizedThreadStart(OnConnect));</div>
<div class="line">        t.Start(<span class="keyword">new</span> ConnectData()</div>
<div class="line">        {</div>
<div class="line">            Session = m_session,</div>
<div class="line">            EndpointUrl = EndpointUrl,</div>
<div class="line">            Security = <a class="code" href="group__GroupNet__UaClientLibraryHelper.html#ga98100b962ed7252c384b7759085977f6">SecuritySelection</a></div>
<div class="line">        });</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">catch</span> (Exception e)</div>
<div class="line">    {</div>
<div class="line">        ExceptionDlg.Show(this.Text, e);</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keyword">public</span> delegate <span class="keywordtype">void</span> ShowExceptionDelegate(<span class="keywordtype">string</span> text, Exception e);</div>
<div class="line"></div>
<div class="line"><span class="keyword">private</span> <span class="keywordtype">void</span> ShowException(<span class="keywordtype">string</span> text, Exception e)</div>
<div class="line">{</div>
<div class="line">    ExceptionDlg.Show(text, e);</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keyword">internal</span> <span class="keyword">class </span>ConnectData</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">public</span> Session Session;</div>
<div class="line">    <span class="keyword">public</span> <span class="keywordtype">string</span> EndpointUrl;</div>
<div class="line">    <span class="keyword">public</span> <a class="code" href="group__GroupNet__UaClientLibraryHelper.html#ga98100b962ed7252c384b7759085977f6">SecuritySelection</a> Security;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keyword">private</span> <span class="keywordtype">void</span> OnConnect(<span class="keywordtype">object</span> state)</div>
<div class="line">{</div>
<div class="line">    ConnectData data = state as ConnectData;</div>
<div class="line">    <span class="keywordflow">try</span></div>
<div class="line">    {</div>
<div class="line">        data.Session.Connect(data.EndpointUrl, data.Security);</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">catch</span> (Exception e)</div>
<div class="line">    {</div>
<div class="line">        <span class="keywordflow">if</span> (InvokeRequired)</div>
<div class="line">        {</div>
<div class="line">            Invoke(<span class="keyword">new</span> ShowExceptionDelegate(ShowException), this.Text, e);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line">        ExceptionDlg.Show(this.Text, e);</div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment --><p> The following code shows how to connect asynchronously to a server.</p>
<div class="fragment"><div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> BeginConnect()</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordflow">try</span></div>
<div class="line">            {</div>
<div class="line">                <span class="comment">// disconnect any existing session.</span></div>
<div class="line">                <span class="keywordflow">if</span> (m_session.ConnectionStatus != <a class="code" href="group__GroupNet__UaClientLibraryHelper.html#ga89f67ff8532517ecb6ccded3ffbeb722">ServerConnectionStatus</a>.Disconnected)</div>
<div class="line">                {</div>
<div class="line">                    m_session.Disconnect();</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">                m_session.BeginConnect(</div>
<div class="line">                    EndpointUrl,</div>
<div class="line">                    <a class="code" href="group__GroupNet__UaClientLibraryHelper.html#ga98100b962ed7252c384b7759085977f6">SecuritySelection</a>,</div>
<div class="line">                    null,</div>
<div class="line">                    <a class="code" href="group__GroupNet__UaClientLibraryHelper.html#gae9f5677b684b8965a39f25695fa292f0">RetryInitialConnect</a>.Yes,</div>
<div class="line">                    m_session.DefaultRequestSettings,</div>
<div class="line">                    OnConnectCompleted,</div>
<div class="line">                    m_session);</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">catch</span> (Exception e)</div>
<div class="line">            {</div>
<div class="line">                ExceptionDlg.ShowInnerException(this.Text, e);</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> OnConnectCompleted(IAsyncResult result)</div>
<div class="line">        {</div>
<div class="line">            <span class="comment">// need to make sure the results are processed on the correct thread.</span></div>
<div class="line">            <span class="keywordflow">if</span> (InvokeRequired)</div>
<div class="line">            {</div>
<div class="line">                BeginInvoke(<span class="keyword">new</span> AsyncCallback(OnConnectCompleted), result);</div>
<div class="line">                <span class="keywordflow">return</span>;</div>
<div class="line">            }</div>
<div class="line"></div>
<div class="line">            <span class="comment">// get the session used to send the request which was passed as the userData in the Begin call.</span></div>
<div class="line">            Session session = (Session)result.AsyncState;</div>
<div class="line"></div>
<div class="line">            <span class="keywordflow">try</span></div>
<div class="line">            {</div>
<div class="line">                session.EndConnect(result);</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">catch</span> (Exception e)</div>
<div class="line">            {</div>
<div class="line">                ExceptionDlg.ShowInnerException(this.Text, e);</div>
<div class="line">            }</div>
<div class="line">        }</div>
</div><!-- fragment --> <div class="fragment"><div class="line"><span class="keyword">private</span> <span class="keywordtype">void</span> BeginConnect()</div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">try</span></div>
<div class="line">    {</div>
<div class="line">        <span class="comment">// disconnect any existing session.</span></div>
<div class="line">        <span class="keywordflow">if</span> (m_session.ConnectionStatus != <a class="code" href="group__GroupNet__UaClientLibraryHelper.html#ga89f67ff8532517ecb6ccded3ffbeb722">ServerConnectionStatus</a>.Disconnected)</div>
<div class="line">        {</div>
<div class="line">            m_session.Disconnect();</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="comment">// start the operation.</span></div>
<div class="line">        m_session.BeginConnect(</div>
<div class="line">            EndpointUrl,</div>
<div class="line">            <a class="code" href="group__GroupNet__UaClientLibraryHelper.html#ga98100b962ed7252c384b7759085977f6">SecuritySelection</a>,</div>
<div class="line">            null,</div>
<div class="line">            <a class="code" href="group__GroupNet__UaClientLibraryHelper.html#gae9f5677b684b8965a39f25695fa292f0">RetryInitialConnect</a>.Yes,</div>
<div class="line">            m_session.DefaultRequestSettings,</div>
<div class="line">            OnConnectCompleted,</div>
<div class="line">            m_session);</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">catch</span> (Exception e)</div>
<div class="line">    {</div>
<div class="line">        ExceptionDlg.Show(this.Text, e);</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"><span class="keyword">private</span> <span class="keywordtype">void</span> OnConnectCompleted(IAsyncResult result)</div>
<div class="line">{</div>
<div class="line">    <span class="comment">// need to make sure the results are processed on the correct thread.</span></div>
<div class="line">    <span class="keywordflow">if</span> (InvokeRequired)</div>
<div class="line">    {</div>
<div class="line">        BeginInvoke(<span class="keyword">new</span> AsyncCallback(OnConnectCompleted), result);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="comment">// get the session used to send the request which was passed as the userData in the Begin call.</span></div>
<div class="line">    Session session = (Session)result.AsyncState;</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">try</span></div>
<div class="line">    {</div>
<div class="line">        session.EndConnect(result);</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">catch</span> (Exception e)</div>
<div class="line">    {</div>
<div class="line">        ExceptionDlg.Show(this.Text, e);</div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment --> </div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="L1ClientTutorials.html">Tutorials for Client development</a></li><li class="navelem"><a class="el" href="L2ClientTutExamples.html">Getting Started</a></li>
    <li class="footer">&copy; Unified Automation GmbH - All rights reserved.</li>
  </ul>
</div>
</body>
</html>
